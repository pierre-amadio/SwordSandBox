
#Building the module require the scrpits and stuff located in this repo : https://git.crosswire.org/cyrille/lxx
# lxx/scripts/imp2osis.sh 
# lxx/scripts/Imp2OsisAlt.sh 

export WORKDIR=`pwd`
export REPO_CYRILLE=/home/melmoth/dev/lxx/

mkdir buildLXX
cd buildLXX
mkdir lxxm-gen
cd lxxm-gen

################################
# Create the imp version. 
# $WORKDIR/buildLXX/002.txt and 
# $WORKDIR/buildLXX/002.alt
################################

#Download the source informations from ccat.sas.upenn.edu

cd "$WORKDIR/buildLXX/lxxm-gen"
wget -r -np http://ccat.sas.upenn.edu/gopher/text/religion/biblical/lxxmorph/
cp -r ccat.sas.upenn.edu/gopher/text/religion/biblical/lxxmorph/ .
# Lets create a directory for the alternative verse too
# and put the alternate chapters there.
mkdir alternate
cd lxxmorph
mv 08.JoshA.mlxx 10.JudgesA.mlxx 60.BelTh.mlxx 62.DanielTh.mlxx 64.SusTh.mlxx 23.TobitS.mlxx ../alternate

#Now let s convert this in imp format with some java stuff
# sources of some class available here: http://www.mneuhold.at/antike/grkconv_en.html
# http://www.mneuhold.at/download/greekconverter-060820-src.zip
#We are now in buildLXX/lxxm-gen
cd $WORKDIR/buildLXX/lxxm-gen
#Let s copy the needed java stuff
cp "$REPO_CYRILLE/scripts/lxxm-gen/lxxm.jar" .
cp -r "$REPO_CYRILLE/scripts/lxxm-gen/greekconverter" .

#Run the java magic
cd $WORKDIR/buildLXX/lxxm-gen/lxxmorph
java -jar ../lxxm.jar [0-9][0-9]\.* > lxxm-decomp.imp
mv lxxm-decomp.imp ../
cd ../
#we are now in $WORKDIR/buildLXX/lxxm-gen
#Lets have normalisation 
#https://unix.stackexchange.com/questions/90100/convert-between-unicode-normalization-forms-on-the-unix-command-line
uconv -x Any-NFC lxxm-decomp.imp > lxxm.imp
rm lxxm-decomp.imp
cp lxxm.imp ../002.txt

#So we have now "$WORKDIR/buildLXX/002.txt" , a default manuscript normalised imp document.

#Now, let s do the same for alternates.
#cd alternate
cd "$WORKDIR/buildLXX/lxxm-gen/alternate"
java -jar ../lxxm.jar [0-9][0-9]\.* > lxxm-decomp-alternate.imp
mv lxxm-decomp-alternate.imp ../
cd ../
uconv -x Any-NFC lxxm-decomp-alternate.imp > lxxm-alternate.imp
rm lxxm-decomp-alternate.imp
cp lxxm-alternate.imp ../002.alt

################################
################################

